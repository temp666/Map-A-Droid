{% extends "base.html" %}

{% block header %}
{% endblock %}

{% block scripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.js"></script>

    <script>
        $(document).ready(function () {
            $("#navgyms").addClass("active");

            var displayResources = $('#show-data');

            displayResources.text('Loading data ...');

            $.ajax({
                type: "GET",
                url: "/get_gyms",
                success: function (result) {
                    console.log(result);
                    var output = "<table><thead><tr><th>Name</th><th>Hash</th><th>Hashpic</th><th>Gympic</th><th>Matchcount</th><th>Last Modify</th><th>Creation Date</th><th>Actions</th></thead><tbody>";
                    for (var i in result) {
                        output += "<tr><td>" + result[i].name + "</td><td>" + result[i].hashvalue + "</td><td><img class='lazy' data-original='" + result[i].filename + "' width=100></td><td><img class='lazy' data-original='" + result[i].gymimage + "' width=100></td><td>" + result[i].count + "</td><td>" + result[i].modify + "</td><td>" + result[i].creation + "</td><td><a href='/modify_gym?hash=" + result[i].hashvalue + "&lat=" + result[i].lat + "&lon=" + result[i].lon + "'>Change Gym</a><br><br><a href='/delete_hash?hash=" + result[i].hashvalue + "&type=gym&redirect=gyms'>Delete</a> </td></tr>";
                    }
                    output += "</tbody></table>";

                    displayResources.html(output);
                    $("table").addClass("table");
                    $('table').DataTable({
                        drawCallback: function () {
                            $("img.lazy").lazyload();
                        },
                        "order": [[{{ sort }}, "desc" ]],
                        responsive: {{ responsive }},
                        "autoWidth": true,
                        columnDefs: [{ targets: [5, 6], type: 'date' }]
                    });
                }
            });
        });
    </script>
{% endblock %}

{% block content %}
    <h2>Check saved Gyms</h2>
    <h4><a href="/">Back to Menu</a></h4>
    <div id="show-data"></div>
{% endblock %}